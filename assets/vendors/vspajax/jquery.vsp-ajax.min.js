!function(window){"use strict";function vsp_Ajax_Elem_Access($element,stats){"block"==stats?$element.vspbutton("loading"):$element.vspbutton("reset")}"undefined"==typeof Library&&(window.VSPAjax=function(AjaxOptions,Options){this.ajax(AjaxOptions,Options)},window.VSPAjaxQ=function(){return this.init(),this}),VSPAjax.prototype={VERSION:"1.0",_Ajax:"",_default_ajax_options:{method:"GET",data:"",url:ajaxurl},_AjaxOptions:{},_Options:{},_mergeArray:function(){var arg,args=Array.prototype.slice.call(arguments),argl=args.length,retObj={},k="",argil=0,j=0,i=0,ct=0,toStr=Object.prototype.toString,retArr=!0;for(i=0;i<argl;i++)if("[object Array]"!==toStr.call(args[i])){retArr=!1;break}if(retArr){for(retArr=[],i=0;i<argl;i++)retArr=retArr.concat(args[i]);return retArr}for(ct=i=0;i<argl;i++)if(arg=args[i],"[object Array]"===toStr.call(arg))for(j=0,argil=arg.length;j<argil;j++)retObj[ct++]=arg[j];else for(k in arg)arg.hasOwnProperty(k)&&(parseInt(k,10)+""===k?retObj[ct++]=arg[k]:retObj[k]=arg[k]);return retObj},_set_Options:function($Options){void 0!==$Options&&(this._Options=$Options)},_set_ajax_options:function($Options){void 0!==$Options&&(this._AjaxOptions=this._mergeArray(this._default_ajax_options,$Options))},_BodyTrigger:function($status){void 0!==this._Options.trigger_code&&jQuery("body").trigger(this._Options.trigger_code,[$status,Options.element,this._AjaxOptions])},_FuncTrigger:function($status,$args){"before"==$status&&"function"===this._Options.before?this._Options.before($args):"after"==$status&&"function"===this._Options.after?this._Options.after($args):"onSuccess"==$status&&"function"===this._AjaxOptions.OnSuccess?this._AjaxOptions.OnSuccess($args):"onError"==$status&&"function"===this._AjaxOptions.onError?this._AjaxOptions.onError($args):"OnAlways"==$status&&"function"===this._AjaxOptions.OnAlways?this._AjaxOptions.OnAlways($args):"AjaxQ"==$status&&jQuery("body").trigger("vsp-ajaxq")},_elementLock:function(stats){this._Options.element_lock&&vsp_Ajax_Elem_Access(this._Options.element,stats)},_handle_response:function(res){return void 0===res.data||void 0===res.data.msg||(this._Options.response_element.html(res.data.msg),!1)},_string_function_callback:function(callback){try{window[callback]()}catch(err){console.log(err)}},_array_function_callback:function(callback){jQuery.each(callback,function(key,value){this._string_function_callback(value)})},_handle_callback:function(res){var $this=this;void 0!==res.data&&void 0!==res.data.callback&&("string"==typeof res.data.callback?$this._string_function_callback(res.data.callback):"object"!=typeof res.data.callback&&"array"!=typeof res.data.callback||jQuery.each(res.data.callback,function(key,value){if(key==parseInt(key))"string"==typeof value?$this._string_function_callback(value):"object"!=typeof value&&"array"!=typeof value||$this._array_function_callback(value);else try{new Function(key,value)()}catch(arr){console.log(arr)}}))},ajax:function(AjaxOptions,Options){this._set_ajax_options(AjaxOptions),this._set_Options(Options),void 0!==AjaxOptions.ajax&&this._set_ajax_options(AjaxOptions.ajax),void 0!==AjaxOptions.options&&this._set_Options(AjaxOptions.options),this._FuncTrigger("before"),this._BodyTrigger("before"),this._elementLock("block"),void 0===this._Options.response_element&&(this._Options.response_element=jQuery(".inline-ajax-response")),this._Ajax=jQuery.ajax(this._AjaxOptions);var $self=this;this._Ajax.done(function(res){$self._elementLock("unblock"),$self._FuncTrigger("onSuccess",res),$self._BodyTrigger("success"),$self._handle_response(res),$self._handle_callback(res)}),this._Ajax.fail(function(res){$self._elementLock("unblock"),$self._handle_response(res.responseJSON.data),$self._handle_callback(res),$self._FuncTrigger("onError",res),$self._BodyTrigger("failed")}),this._Ajax.always(function(res){$self._elementLock("unblock"),$self._FuncTrigger("onAlways",res),$self._FuncTrigger("AjaxQ"),$self._BodyTrigger("always")}),this._FuncTrigger("after"),this._BodyTrigger("after")}},VSPAjaxQ.prototype={ajax_queue:[],is_ajax_ongoing:!1,init:function(){var $self=this;jQuery("body").on("vsp-ajaxq",function(){void 0!==$self.ajax_queue[0]?($self.ajax_queue[0].elem.removeClass("vspajaxq-in-queue"),$self.ajax_queue.shift(),$self.kick_start_ajax()):this.is_ajax_ongoing=!1})},kick_start_ajax:function(){this.is_ajax_ongoing=!0,void 0!==this.ajax_queue[0]?new VSPAjax(this.ajax_queue[0].data):this.is_ajax_ongoing=!1},add:function($ele,$data){$ele.hasClass("vspajaxq-in-queue")||(this.ajax_queue.push({elem:$ele,data:$data}),$ele.addClass("vspajaxq-in-queue"),vsp_Ajax_Elem_Access($ele,"block"),!1===this.is_ajax_ongoing&&this.kick_start_ajax())}}}(window);